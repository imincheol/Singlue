# 기능 명세 (Feature Specifications)

## 1. 핵심 기능 (Core Features)
### 🎵 YouTube Player Integration
- **영상 재생**: YouTube 영상을 앱 내에서 바로 재생합니다.
- **재생 제어**: 재생/일시정지, 영상 탐색(Skip) 등 기본적인 플레이어 기능을 제공합니다.

### 🤖 AI Curator (Gemini)
- **AI 큐레이터**: AI가 영상의 내용을 분석하여 실시간으로 가사 데이터를 생성합니다.
- **가사 생성**: 원문 가사뿐만 아니라 발음(Pronunciation)과 해석(Translation)까지 자동으로 생성합니다.
- **힌트 제공**: 사용자가 정확한 생성을 위해 가수나 노래 제목 등 힌트를 줄 수 있습니다.

### ✨ AI Lyrics Enrichment
- **가사 채우기**: 검색해온 가사에 발음이나 해석이 없는 경우, AI가 부족한 정보를 자동으로 채워줍니다.
- **국가 자동 식별**: 노래 가사 및 정보를 분석하여 노래의 국가(Country Code)를 자동으로 식별하고 국기를 표시합니다.
- **스마트 메타데이터 파싱**: 유튜브 영상 제목에서 가수와 곡 제목을 AI가 정확하게 분리하여 추출합니다.
- **다국어 맞춤 생성**: 사용자가 선택한 언어(App Language)에 맞춰 발음과 해석을 생성합니다.
  - **한국어(KO)**: 발음은 한글로 표기(예: "Xin chào" -> "씬 짜오"), 해석은 한국어로 제공.
  - **영어(EN)**: 발음은 로마자로 표기(예: "Annyeong" -> "Annyeong"), 해석은 영어로 제공.
  - **베트남어(VI)**: 발음/해석이 불필요한 경우 생략하거나 원문 유지.
- **베트남어 발음 표기 기준**: 베트남어 가사를 다른 언어로 발음 표기할 때는 **북부 발음(Hanoi 표준)**을 기준으로 합니다.
  - 예: "Không" -> "콩" (북부), "Cảm ơn" -> "깜 언" (북부)
- **자동 감지**: 불완전한 가사가 로드되면 "AI로 채우기" 버튼이 자동으로 활성화됩니다.

### 🔍 Lyrics Search & Sync
- **가사 검색**: 전 세계 노래 가사 데이터베이스(LRCLIB)에서 원하는 곡을 검색합니다.
- **싱크 매핑**: 검색된 가사를 현재 재생 중인 유튜브 영상과 연결(Mapping)하여 저장합니다.
- **클라우드 공유**: 매핑된 가사 정보와 싱크 오프셋은 **Supabase**에 저장되어 모든 사용자가 공유할 수 있습니다.
  - **데이터 무결성**: 사용자가 '가사 변경' 등을 통해 단계를 진행할 때마다 새로운 레코드를 생성하지 않고, 기존 곡 ID를 유지하며 업데이트(Upsert)하여 중복 데이터를 방지합니다.
- **다국어 저장**: 한 번 생성된 가사의 발음/해석은 언어별(KO, EN 등)로 구분되어 저장됩니다. 다음에 다른 사용자가 접속하면 설정된 언어에 맞는 발음을 즉시 불러옵니다.
- **URL 처리**: 플레이리스트 파라미터(`?list=...`)가 포함된 URL이나 쇼츠(`shorts/`) URL에서도 비디오 ID를 정확하게 추출하여 등록할 수 있도록 지원합니다.
- **스마트 정렬**: 영상 길이와 가장 비슷한 결과물을 우선적으로 보여주어 정확도를 높입니다.

### 📝 Lyrics Display System
- **3단 가사 보기**: [원문] - [발음] - [해석]을 한눈에 볼 수 있는 3단 구조를 제공합니다.
- **맞춤형 토글**: 발음이나 해석이 필요 없을 경우 켜고 끌 수 있습니다.
- **자동 스크롤**: 노래 재생에 맞춰 현재 가사가 강조되고 자동으로 스크롤됩니다.
- **미니 뷰어**: 플레이어 화면 하단에 현재 가사 3줄을 간략하게 보여줍니다.

### 🌍 Internationalization (다국어 지원)
- **지원 언어**: 한국어(KO), 영어(EN), 베트남어(VI).
- **자동 설정**: 사용자의 브라우저 설정에 맞춰 언어가 자동으로 적용됩니다.
- **레이아웃 최적화**: 베트남어 등 문장이 긴 언어에서도 메인 타이틀이 3줄을 넘지 않도록 레이아웃 및 텍스트를 최적화합니다.
- **UI 현지화 (Localization)**:
  - 앱 내 모든 정적 텍스트(메뉴, 버튼, 안내 메시지, 에러 메시지 등)는 선택된 언어(KO, EN, VI)에 맞춰 번역되어 표시되어야 합니다.
  - 특히 **전역 네비게이션(Navigation)**, **인증 페이지(Auth)**, **곡 등록 마법사(Song Registration Wizard)**, **플레이어 컨트롤(Sync, Rate 등)**, **홈 화면 안내 문구** 등 사용자와 상호작용이 많은 부분은 반드시 다국어를 지원해야 합니다.
  - 하드코딩된 문자열 사용을 금지하고, `i18n` 라이브러리를 통해 리소스를 관리합니다.
  - 설계 단계에서 정의된 다국어 키와 값을 기반으로 구현하며, 언어별 문구 길이에 따른 레이아웃 깨짐을 디자인 단계에서 고려합니다.

## 2. 사용자 편의 기능 (UX)
### ⏯️ Player Controls
- **재생 컨트롤**: 재생/일시정지, 10초 건너뛰기, 탐색 바 등 영상 제어 기능.
- **자막 컨트롤**:
  - **배속 조절**: 0.5배속 ~ 2.0배속까지 속도 조절 가능.
  - **싱크 조절**: 영상과 가사가 맞지 않을 때 미세하게 조정(±0.1초 등) 가능.
  - **가사 변경**: 언제든지 다른 가사로 다시 검색하거나 변경 가능.
- **정보 새로고침 (AI)**: 영상 제목에서 정확한 가수/제목 정보를 가져오지 못한 경우, AI를 통해 다시 분석하고 업데이트할 수 있는 버튼을 제공합니다.
- **정보 새로고침**: 영상 정보가 제대로 로드되지 않았을 때 다시 불러오는 기능.

### 📌 General UI
- **버전 표시**: 상단 헤더의 로고 옆에 현재 앱의 버전(예: v0.0.1)을 표시하여, 사용자가 현재 접속한 배포 버전을 쉽게 확인할 수 있도록 합니다.
- **테마 토글 (Dark/Light Mode)**: 
  - 상단 헤더에 다크/라이트 모드 전환 버튼을 제공합니다.
  - 최초 접속 시 기기의 시스템 테마 설정을 자동으로 감지하여 적용합니다.
  - 해/달 아이콘으로 직관적인 UI를 제공합니다.
  - 사용자의 테마 선택은 `localStorage`에 저장되어 다음 방문 시에도 해당 설정대로 유지됩니다.
  - 모든 페이지와 컴포넌트에서 일관된 테마가 적용됩니다.
- **최신 공개 영상 목록 (Recently Added)**:
  - 홈 화면 하단에 최근에 공개된(Stage 3 완료) 영상 목록을 표시합니다.
  - 최신순으로 정렬하여 최대 20개까지 노출합니다.
  - 각 카드는 썸네일, 제목, 가수, 등록일, 국기(Country Flag) 정보를 포함합니다.
  - 반응형 그리드 레이아웃을 사용하여 다양한 해상도에 최적화합니다.


### 📚 Community Library (Global)
- **섹션 구성**:
  - **즐겨찾기**: 사용자가 하트 표시를 한 곡들.
  - **공개된 노래 (Completed)**: Stage 3 완료 및 공개 설정된 곡들.
  - **작업 중인 노래**: Stage 1(영상 등록), Stage 2(가사 매칭) 단계의 곡들. 상태 레이블을 통해 단계를 표시합니다.
- **실시간 업데이트**: 새로운 곡이 등록되면 라이브러리 목록에 즉시 반영됩니다. (새로고침 시)
- **정보 표시**: 썸네일(YouTube), 곡 제목(Artist - Title), 등록일, 제작자 등의 정보를 제공합니다.

### ⏯️ System Feedback & Messaging
- **No Alert Experience**: 브라우저 기본 팝업 알림을 사용하지 않고, 앱 내 UI를 통해 모든 성공/실패 메시지를 전달함으로써 끊김 없는 사용자 경험을 제공합니다.
- **Localization**: 모든 시스템 메시지는 다국어 엔진을 통해 현지화되어 제공됩니다.
- **State Passing**: 페이지 전환 시 발생하는 알림(예: 회원가입 완료 후 로그인 페이지에서 안내)은 Router State를 활용하여 인라인으로 표시하거나 토스트 알림으로 처리합니다.


## 3. 멤버십 시스템 (Membership System)
### 👤 User Management
- **회원가입/로그인**: 이메일 및 비밀번호 기반의 인증 시스템.
- **이메일 인증**: 보안을 위해 가입 시 입력한 이메일로 인증 링크가 발송됩니다. 링크를 클릭하여 인증을 완료해야 로그인이 가능합니다.
- **역할 관리**: 
  - `admin`: 모든 사용자 관리 권한 보유.
  - `user`: 일반 회원. 개인 라이브러리 및 노래 등록 기능 사용 가능. (이메일 인증 후 이용 가능)

### 🔑 Quota & Licensing
- **Free Quota**: 신규 가입 회원은 별도의 API 키 없이 최대 **10곡**까지 AI 기능을 무료로 사용할 수 있습니다.
- **BYOK (Bring Your Own Key)**: 10곡을 초과하여 생성하려면 본인의 Gemini API Key를 등록해야 합니다. (Settings 페이지)

### 📝 Song Registration Workflow
- **단계별 등록 (Wizard)**:
  - **자동 등록 (Stage 1)**: 영상 재생 시 자동으로 기본 정보(제목, 영상 ID)가 등록됩니다.
  - **Step 1 (기본 정보)**: 썸네일, 제목, 가수 정보 입력.
  - **Step 2 (가사 입력)**: LRC 포맷 또는 텍스트 가사 입력.
  - **Step 3 (AI Enrichment)**: Gemini를 이용해 발음 및 해석 자동 생성.
- **접근 권한 (Access Control)**:
  - **게스트**: 'Stage 3 (Public)' 상태의 공개된 곡만 열람 가능.
  - **회원**: 본인이 등록한 곡(모든 단계) 및 공개된 곡 열람 가능.
- **나만의 라이브러리**: `/library` 페이지에서 본인이 등록한 곡 목록 및 진행 상태(Stage 1~3) 확인 가능.

## 4. 설정 (Settings)
- **발음/해석 표시 설정**: 학습 스타일에 따라 UI를 커스터마이징 할 수 있습니다.
- **발음/해석 표시 설정**: 학습 스타일에 따라 UI를 커스터마이징 할 수 있습니다.
- **API 키 관리**: 사용자가 본인의 Gemini API 키를 등록하여 **무제한**으로 AI 기능을 사용할 수 있습니다.
- **쿼터 확인**: 현재 무료 쿼터 사용량(예: 3/10)을 확인할 수 있습니다.
- **Gemini 모델 전략**:
- **Gemini 모델 전략**:
  - **Primary Model**: `gemini-3-pro-preview` (최신 Reasoning 모델)
  - **Fallback System**: API 오류 발생 시 다음 순서대로 모델을 자동 전환:
    1. `gemini-3-pro-preview`
    2. `gemini-1.5-flash-002`
    3. `gemini-1.5-flash`
    4. `gemini-1.5-flash-001`
    5. `gemini-1.5-pro`
    6. `gemini-2.0-flash-exp`
  - **목적**: 
    - 최신 Gemini 3의 추론 능력 활용.
    - 404/429 오류에 대한 강력한 내성 확보.




## 5. 수익 및 비즈니스 모델 (Monetization)
### 💰 Phase 1: Traffic & Ads (Current)
- **Google AdSense**:
  - `ads.txt` 설정을 통해 구글 애드센스 승인을 준비합니다.
  - 배너 광고 및 보상형 광고(Reward Ads) 도입을 검토합니다.

### 💳 Phase 2: Subscription (Planned)
- **Singlue Plus (구독 모델)**:
  - **Zero Config**: 복잡한 설정 없이 바로 이용 가능 (API 비용 플랫폼 대납).
  - **Premium Features**: 오프라인 저장, 심화 학습 기능(Dictation, Shadowing) 제공 예정.

### 🤝 Phase 3: B2B & Data (Future)
- **데이터 API**: 정제된 가사/발음/싱크 데이터를 타 플랫폼에 제공.
- **교육 기관용**: 어학원 및 학교를 위한 선생님용 대시보드 제공.


## 6. 배포 및 SEO 설정 (Deployment & SEO)
- **메타데이터 설정**: 검색 엔진 최적화(SEO)를 위한 Title, Description, Keywords 메타 태그 설정.
- **Open Graph (OG) 태그**: SNS(Facebook, Twitter, KakaoTalk 등) 공유 시 링크 미리보기를 위한 제목, 설명, 썸네일 이미지 설정.
- **파비콘 (Favicon)**: 브라우저 탭 및 홈 화면 바로가기에 표시될 애플리케이션 아이콘 설정.
- **검색 로봇 제어 (Robots.txt)**: 검색 엔진 크롤러의 접근을 제어하고 사이트맵 위치를 명시.
- **사이트맵 (Sitemap)**: 검색 엔진이 사이트 구조를 파악할 수 있도록 URL 목록 제공 (`sitemap.xml`).
- **웹 앱 매니페스트 (Web App Manifest)**: 모바일 홈 화면 추가 시 앱처럼 동작하도록 `manifest.json` 설정 (PWA 기본 요건).
- **구조화된 데이터 (JSON-LD)**: 검색 결과에 소프트웨어/앱 정보가 잘 표시되도록 Schema.org 표준 데이터 추가.
- **표준 주소 (Canonical URL)**: 중복 콘텐츠 방지를 위한 대표 URL 설정.
